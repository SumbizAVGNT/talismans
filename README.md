# MoonTalismans v2.0

Плагин греческих талисманов и сфер с уникальными боевыми механиками, атрибутами, визуальными эффектами и системой пассивных способностей для PvP-серверов.

## Что нового в v2.0

- **Исправлена система атрибутов** - атрибуты теперь корректно применяются к PLAYER_HEAD (сферам) и TOTEM_OF_UNDYING (талисманам)
- **Уникальные боевые механики** - каждый талисман и сфера имеет особые способности
- **Система партиклов** - визуальные эффекты вокруг игроков с активными предметами
- **Улучшенный GUI** - современный интерфейс с информацией об атрибутах и рецептах
- **35 предметов** - 18 талисманов и 17 сфер с греческой тематикой

## Требования

- Paper 1.20.6+
- Java 21+
- (Опционально) Nexo для кастомных текстур

## Установка

1. Скачайте JAR файл
2. Поместите в папку `plugins/`
3. Перезапустите сервер
4. Настройте `plugins/MoonTalismans/config.yml`

---

## Команды

| Команда | Описание |
|---------|----------|
| `/talismans give <id> [amount] [player]` | Выдать предмет |
| `/talismans list` | Список всех предметов |
| `/talismans reload` | Перезагрузить конфигурацию |
| `/talismans debug` | Показать информацию о предмете в руке |
| `/talismans gui [page]` | Открыть админ-GUI |

## Разрешения

| Разрешение | Описание |
|------------|----------|
| `moontalismans.admin` | Доступ ко всем командам |
| `moontalismans.give` | Выдача предметов |
| `moontalismans.reload` | Перезагрузка |

---

## Уникальные механики

### Боевые способности талисманов

| Талисман | Механика |
|----------|----------|
| **Феникс** | Возрождение при смертельном уроне (30% HP, кулдаун 5 мин), регенерация при низком здоровье |
| **Кобра** | 30% шанс отравить цель при ударе |
| **Ехидна** | 15% вампиризм - восстановление здоровья от нанесённого урона |
| **Каратель** | +20% дополнительного урона при критических ударах |
| **Крайт** | 25% шанс замедлить цель при ударе |
| **Крушитель** | 20% шанс оглушить цель (замедление копания + тошнота) |
| **Эгида** | -10% получаемого урона + пассивный эффект сопротивления |
| **Грани** | Ускорение Speed II при получении урона |
| **Тритон** | Водное дыхание + Грация дельфина под водой |
| **Лекарь** | Пассивная медленная регенерация |

### Боевые способности сфер

| Сфера | Механика |
|-------|----------|
| **Химера** | 35% шанс наложить случайный негативный эффект (яд/увядание/слепота/слабость/замедление) |
| **Пандора** | 25% шанс AOE ослабления врагов в радиусе 3 блоков |
| **Осирис** | 15% отражение урона + ночное зрение |
| **Афина** | Сила при здоровье ниже 50% |
| **Титан** | Дополнительная защита при получении урона |
| **Магма** | Пассивная огнестойкость |
| **Астрея** | Пассивное ночное зрение |
| **Теургия** | Пассивное поглощение урона (Absorption) |
| **Иасо** | Пассивное насыщение |

### Визуальные эффекты

Сферы и талисманы создают уникальные частицы вокруг игрока:

| Предмет | Партиклы |
|---------|----------|
| Феникс | Огненные частицы (FLAME) |
| Магма | Частицы лавы (LAVA) |
| Тритон | Пузыри под водой (BUBBLE_COLUMN_UP) |
| Химера | Магические частицы (ENCHANT) |
| Аполлон | Светящиеся частицы (END_ROD) |
| Андромеда | Портальные частицы (PORTAL) |
| Пандора | Частицы ведьмы (WITCH) |
| Титан | Критические частицы (CRIT) |
| Другие сферы | Фиолетовая пыль (DUST) |

---

## Админ-GUI

### Основное меню (`/talismans gui`)

- **45 слотов** на страницу с пагинацией
- **ЛКМ** по предмету — выдать себе
- **ПКМ** по предмету — открыть редактор рецепта
- **Информация** — количество талисманов/сфер, атрибутов
- **Перезагрузка** — обновить конфиг без рестарта

### Редактор рецептов

1. Откройте `/talismans gui` и нажмите ПКМ по предмету
2. Разместите ингредиенты в сетке 3x3 слева
3. Нажмите "Сохранить рецепт" (зелёная кнопка)
4. Рецепт сохранится в `config.yml` и зарегистрируется автоматически

---

## Конфигурация

### Структура предмета

```yaml
items:
  item_id:
    enabled: true
    display_name: "&#f0f034Ξ &fНазвание"
    lore:
      - ""
      - "&7Когда во второстпеной руке:"
      - "&9+5 Урон"
      - "&d⚔ Особая способность"
    glint: true
    item_flags:
      - HIDE_ATTRIBUTES
    resource:
      material: TOTEM_OF_UNDYING  # или PLAYER_HEAD для сфер
      generate: false
      model_path: item/talisman
    # Для сфер:
    head_texture_base64: "eyJ0ZXh0dXJlcyI6..."
    attribute_modifiers:
      offhand:
        attackDamage: 5
        maxHealth: -2
        armor: 2
    effects:
      passive_potions:
        - type: NIGHT_VISION
          duration: 300
          amplifier: 0
          ambient: true
          particles: false
          icon: true
      damage_reflect: 0.15
```

### Доступные атрибуты

| Имя в конфиге | Описание | Примечание |
|---------------|----------|------------|
| `attackDamage`, `damage` | Урон | Целые числа |
| `attackSpeed` | Скорость атаки | 0.01 = 1% |
| `maxHealth`, `health` | Макс. здоровье | 1 = 0.5 сердца |
| `armor` | Броня | Целые числа |
| `armorToughness`, `toughness` | Твёрдость брони | Целые числа |
| `movementSpeed`, `speed` | Скорость ходьбы | 0.01 = 10% |
| `luck` | Удача | Целые числа |
| `knockbackResistance` | Сопр. отбрасыванию | 0-1 |
| `attackKnockback` | Отбрасывание | Целые числа |
| `flyingSpeed` | Скорость полёта | 0.01 = 1% |

### Слоты активации

| Слот | Описание |
|------|----------|
| `offhand` | Вторая рука (рекомендуется) |
| `mainhand` | Основная рука |
| `hand` | Любая рука |
| `head`, `chest`, `legs`, `feet` | Слоты брони |
| `armor` | Любой слот брони |
| `any` | Где угодно |

---

## Список предметов

### Талисманы (18 шт.)

| ID | Название | Основные бонусы | Способность |
|----|----------|-----------------|-------------|
| `talisman_fugu` | Талисман Фуги | +6 урон, -2 HP, -4 броня | - |
| `talisman_egida` | Талисман Эгида | +2 броня, +2 твёрдость | -10% урона, сопротивление |
| `talisman_karatelya` | Талисман Карателя | +7 урон, +10% скорость, -4 HP | +20% крит урон |
| `talisman_kraita` | Талисман Крайта | +4 урон, +2 броня, -25% атака | 25% замедление |
| `talisman_kobry` | Талисман Кобры | +5 урон, -4 HP | 30% отравление |
| `talisman_manesa` | Талисман Манеса | +30% атака, -2 урон | - |
| `talisman_lekarya` | Талисман Лекаря | +6 HP, -4 броня | Регенерация |
| `talisman_dionisa` | Талисман Диониса | +2 урон, +15% атака, +10% скорость | - |
| `talisman_gefesta` | Талисман Гефеста | +3 урон, +2 HP, +20% атака, -50% скорость | - |
| `talisman_khauberka` | Талисман Хауберка | +5 урон, -15% скорость | - |
| `talisman_krushitelya` | Талисман Крушителя | +3 урон, +4 HP, +2 броня | 20% оглушение |
| `talisman_grani` | Талисман Грани | +15% скорость, +3 урон, -4 HP | Speed при уроне |
| `talisman_dedala` | Талисман Дедала | +5 урон, -4 HP | - |
| `talisman_tritona` | Талисман Тритона | +3 броня, +2 HP, -3 твёрдость | Водное дыхание |
| `talisman_garmonii` | Талисман Гармонии | +2 урон, +2 HP, +2 броня | - |
| `talisman_feniksa` | Талисман Феникса | +6 HP, +10% атака | Возрождение! |
| `talisman_ekhidny` | Талисман Ехидны | +6 урон, -2 броня, -4 HP | 15% вампиризм |

### Сферы (17 шт.)

| ID | Название | Основные бонусы | Способность |
|----|----------|-----------------|-------------|
| `iaso` | Сфера Иасо | +1 броня, +1 твёрдость | Насыщение |
| `skifa` | Сфера Скифа | +10% атака, +10% скорость, -2 броня | - |
| `abanta` | Сфера Абанты | +2 HP, +1 удача | - |
| `filona` | Сфера Филона | +20% атака, +2 HP | - |
| `sorana` | Сфера Сорана | +3 урон, +2 HP, -3 броня | - |
| `epion` | Сфера Эпиона | +3 урон, -2 HP | - |
| `afina` | Сфера Афина | +15% скорость, +15% атака, +3 урон, -2 HP | Сила при низком HP |
| `panakea` | Сфера Панакея | +4 урон, -2 HP | - |
| `magma` | Сфера Магмы | +2 броня, +2 твёрдость, -15% скорость | Огнестойкость |
| `teurgia` | Сфера Теургия | +4 урон, +4 HP, -15% атака | Поглощение |
| `andromeda` | Сфера Андромеды | +15% скорость, +2 броня, +3 урон, -4 HP | - |
| `pandora` | Сфера Пандоры | +5 урон, +10% скорость, -2 броня | AOE ослабление |
| `titan` | Сфера Титана | +3 броня, +3 твёрдость, -15% скорость | Защита |
| `apollon` | Сфера Аполлона | +4 урон, -10% скорость | - |
| `astreya` | Сфера Астрея | +4 HP, +3 урон, -15% атака | Ночное зрение |
| `osiris` | Сфера Осириса | +3 броня, +1 твёрдость, -15% отдача | 15% отражение |
| `chimera` | Сфера Химеры | +3 урон, +15% атака, -2 HP | 35% случайные эффекты |

---

## Настройки эффектов

```yaml
effects:
  passive_effects_enabled: true    # Включить пассивные эффекты
  particles_enabled: true          # Включить частицы
  effect_refresh_interval: 40      # Интервал обновления (тики)
  particle_interval: 10            # Интервал частиц (тики)

  mechanics:
    phoenix:
      enabled: true
      low_health_threshold: 0.3
      low_health_regeneration:
        duration: 60
        amplifier: 1
      revive:
        health_multiplier: 0.3
        regeneration:
          duration: 100
          amplifier: 2
        fire_resistance:
          duration: 100
          amplifier: 0
      cooldown: 300000

    cobra:
      enabled: true
      chance: 0.30
      poison:
        duration: 60
        amplifier: 0

    echidna:
      enabled: true
      lifesteal: 0.15

    punisher:
      enabled: true
      crit_bonus: 1.20

    krait:
      enabled: true
      chance: 0.25
      slowness:
        duration: 40
        amplifier: 1

    crusher:
      enabled: true
      chance: 0.20
      mining_fatigue:
        duration: 60
        amplifier: 2
      nausea:
        duration: 60
        amplifier: 0

    chimera:
      enabled: true
      chance: 0.35
      effect:
        duration: 60
        amplifier: 0

    pandora:
      enabled: true
      chance: 0.25
      radius: 3.0
      weakness:
        duration: 60
        amplifier: 0

    aegis:
      enabled: true
      damage_reduction: 0.90
      resistance:
        duration: 60
        amplifier: 0

    titan:
      enabled: true
      resistance:
        duration: 40
        amplifier: 0

    osiris:
      enabled: true
      reflect: 0.15
```

---

## Текстуры голов

Текстуры для сфер можно найти на [minecraft-heads.com](https://minecraft-heads.com).
Используйте значение из поля "Value" (base64 строка) в `head_texture_base64`.

---

## Интеграция с Nexo

```yaml
items:
  my_talisman:
    resource:
      from_nexo: my_nexo_item_id  # ID предмета из Nexo
```

---

## Примечания

1. **Атрибуты** применяются автоматически когда предмет в указанном слоте
2. **Сферы** определяются по материалу `PLAYER_HEAD` или наличию `head_texture_base64`
3. **Боевые механики** работают только когда предмет во второй руке (offhand)
4. Значения `movementSpeed` задаются как десятичные дроби (0.01 = ~10% скорости)
5. **Феникс** может возродить только раз в 5 минут

---

## Лицензия

MIT License
